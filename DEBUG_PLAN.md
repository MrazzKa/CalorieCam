# –ü–ª–∞–Ω –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ Railway-–ª–æ–≥–∏

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ

### Backend (NestJS)
1. ‚úÖ –°–æ–∑–¥–∞–Ω `apps/api/src/debug/debug.controller.ts` - –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –ø—Ä–∏—ë–º–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ª–æ–≥–æ–≤
2. ‚úÖ –°–æ–∑–¥–∞–Ω `apps/api/src/debug/debug.module.ts` - –º–æ–¥—É–ª—å –¥–ª—è debug
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `DebugModule` –≤ `AppModule`

### Client (React Native)
1. ‚úÖ –°–æ–∑–¥–∞–Ω `src/utils/clientLog.ts` - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤ –Ω–∞ backend
2. ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω `index.js` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–Ω–Ω–∏—Ö —ç—Ç–∞–ø–∞—Ö:
   - `index:start` - JS –Ω–∞—á–∞–ª –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è
   - `index:AppImportedOK` - App.js —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
   - `index:AppImportError` - –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ App.js (—Å –¥–µ—Ç–∞–ª—è–º–∏)
3. ‚úÖ –°–æ–∑–¥–∞–Ω –ø—Ä–æ—Å—Ç–µ–π—à–∏–π SmokeTest App:
   - –ë–µ–∑ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏, –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤, i18n, Reanimated
   - –ü—Ä–æ—Å—Ç–æ–π —ç–∫—Ä–∞–Ω —Å —Ç–µ–∫—Å—Ç–æ–º "EatSense Smoke Test"
   - –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ `App:mounted` –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å backend
```bash
git add apps/api/src/debug apps/api/app.module.ts
git commit -m "feat: add DebugController for client-side logging"
git push
# –î–æ–∂–¥–∞—Ç—å—Å—è –¥–µ–ø–ª–æ—è –Ω–∞ Railway
```

### 2. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
```bash
git add src/utils/clientLog.ts src/utils/env.ts index.js App.js
git commit -m "feat: add client-side logging for production debugging"
git push
```

### 3. –°–æ–±—Ä–∞—Ç—å production –±–∏–ª–¥
```bash
pnpm dlx eas-cli@latest build -p ios --profile production
```

### 4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ TestFlight –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

### 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Railway-–ª–æ–≥–∏
–ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ, –≤ Railway-–ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:

**–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
[CLIENT_LOG] {"stage":"index:start","platform":"ios","build":"25","env":"production",...}
[CLIENT_LOG] {"stage":"index:AppImportedOK","platform":"ios","build":"25","env":"production",...}
[CLIENT_LOG] {"stage":"App:mounted","platform":"ios","build":"25","env":"production",...}
```

**–ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞:**
```
[CLIENT_LOG] {"stage":"index:start",...}
[CLIENT_LOG] {"stage":"index:AppImportError","extra":{"message":"...","stack":"..."},...}
```

### 6. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### –í–∞—Ä–∏–∞–Ω—Ç A: –í–∏–¥–∏—à—å –ª–æ–≥–∏ `index:start` ‚Üí `index:AppImportedOK` ‚Üí `App:mounted`
‚úÖ **–†–∞–Ω—Ç–∞–π–º —Ä–∞–±–æ—Ç–∞–µ—Ç!** JS —Å—Ç–∞—Ä—Ç—É–µ—Ç, App –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è.
‚Üí –ï—Å–ª–∏ –≤–∏–¥–∏—à—å **–±–µ–ª—ã–π —ç–∫—Ä–∞–Ω**, –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–Ω–æ —ç—Ç–æ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ —Å —Ç–∞–∫–∏–º –ø—Ä–æ—Å—Ç—ã–º App).
‚Üí –ï—Å–ª–∏ –≤–∏–¥–∏—à—å **—Ç–µ–∫—Å—Ç "EatSense Smoke Test"**, –∑–Ω–∞—á–∏—Ç —Ä–∞–Ω—Ç–∞–π–º –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏ –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Å—Ç–∞—Ä–æ–º App –∫–æ–¥–µ.

#### –í–∞—Ä–∏–∞–Ω—Ç B: –í–∏–¥–∏—à—å `index:start`, –Ω–æ –Ω–µ—Ç `index:AppImportedOK`
‚ùå **–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ App.js**
‚Üí –°–º–æ—Ç—Ä–∏ `index:AppImportError` –≤ –ª–æ–≥–∞—Ö - —Ç–∞–º –±—É–¥–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å—Ç–µ–∫ –æ—à–∏–±–∫–∏.
‚Üí –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞, –ø—Ä–æ–±–ª–µ–º–∞ —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏, –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å babel/–º–µ—Ç—Ä–æ.

#### –í–∞—Ä–∏–∞–Ω—Ç C: –ù–µ –≤–∏–¥–∏—à—å –¥–∞–∂–µ `index:start`
‚ùå **–û—á–µ–Ω—å —Ä–∞–Ω–Ω–∏–π –∫—Ä–∞—à** –∏–ª–∏ **–ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ API**
‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
  - –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ API –Ω–∞ Railway?
  - –î–æ—Å—Ç—É–ø–µ–Ω –ª–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/debug/client-log`?
  - –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Ç—å—é/SSL –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ?

## üîÑ –®–∞–≥ 4: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ SmokeTest —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π App –ø–æ —à–∞–≥–∞–º:

### –®–∞–≥ 4.1: –í–µ—Ä–Ω—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é (–±–µ–∑ —Ç–µ–º/i18n)
- –í–µ—Ä–Ω—É—Ç—å `NavigationContainer` –∏ –ø—Ä–æ—Å—Ç–æ–π `Stack.Navigator`
- –î–æ–±–∞–≤–∏—Ç—å `clientLog('Nav:ready')` –≤ `onReady`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

### –®–∞–≥ 4.2: –í–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (—Å –∑–∞—â–∏—Ç–æ–π)
- –í–µ—Ä–Ω—É—Ç—å `ThemeProvider`, `AuthProvider`, `I18nProvider`
- –í–µ–∑–¥–µ –¥–æ–±–∞–≤–∏—Ç—å try/catch –∏ fallback –∑–Ω–∞—á–µ–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å `clientLog('Provider:Theme', ...)` –∏ —Ç.–¥.

### –®–∞–≥ 4.3: –í–µ—Ä–Ω—É—Ç—å MainTabs (—Å –∑–∞—â–∏—Ç–æ–π)
```javascript
function MainTabs() {
  let theme = {};
  try {
    theme = useTheme() || {};
  } catch {
    theme = {};
  }

  const colors = theme.colors || {
    primary: '#007AFF',
    textTertiary: '#8E8E93',
    tabBackground: '#FFFFFF',
    border: '#E5E5EA',
  };

  let t = (k) => k;
  try {
    const i18n = useI18n();
    t = i18n?.t || ((k) => k);
  } catch {
    t = (k) => k;
  }

  useEffect(() => {
    clientLog('MainTabs:mounted', {
      hasTheme: !!theme,
      hasI18n: t !== ((k) => k),
    }).catch(() => {});
  }, []);

  // ... Tab.Navigator
}
```

### –®–∞–≥ 4.4: –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã
- –í–µ—Ä–Ω—É—Ç—å —ç–∫—Ä–∞–Ω—ã –ø–æ –æ–¥–Ω–æ–º—É
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–∞–∂–¥—ã–π —ç–∫—Ä–∞–Ω
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

- –í—Å–µ –≤—ã–∑–æ–≤—ã `clientLog` –æ–±—ë—Ä–Ω—É—Ç—ã –≤ `.catch(() => {})` —á—Ç–æ–±—ã –Ω–µ –∫—Ä–∞—à–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –õ–æ–≥–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –ø–æ —Ä–∞–∑–º–µ—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, stack trace –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤)
- Build number –±–µ—Ä—ë—Ç—Å—è –∏–∑ `Constants.expoConfig` –∏–ª–∏ fallback –Ω–∞ `safeEnv.buildNumber`

## üîß –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ App

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π App:
```bash
# –ï—Å–ª–∏ –µ—Å—Ç—å backup
cp App.js.backup App.js

# –ò–ª–∏ –∏–∑ git
git checkout HEAD -- App.js
```

## ‚ú® –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø–ª–∞–Ω–∞:
1. –ë—É–¥–µ–º –∑–Ω–∞—Ç—å —Ç–æ—á–Ω–æ, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –°–º–æ–∂–µ–º –≤–∏–¥–µ—Ç—å –æ—à–∏–±–∫–∏ –≤ Railway-–ª–æ–≥–∞—Ö
3. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–µ—Ä–Ω—ë–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
4. –ù–∞–π–¥—ë–º –∏ –∏—Å–ø—Ä–∞–≤–∏–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç –±–µ–ª—ã–π —ç–∫—Ä–∞–Ω

